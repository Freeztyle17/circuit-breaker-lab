# Проблема:
В распределенных системах сервисы общаются друг с другом. Периодически какие-то из сервисов становятся недоступными. В такой ситуации нужно каким-то образом максимально надежно и без урона для трафика/системы обрабатывать эти ошибки.  

## Решение:
Паттерн Circuit Breaker  

## Реализация
Нужно реализовать 2 сервиса, которые общаются по http друг с другом. Один из таких сервисов выступаем клиентом, другой - сервером.  

Сервер периодически отдает ошибки (http code >= 500). Клиентский сервис должен реагировать на ошибки, обрабатывая их. Реализовать механизм retry - после первой ошибки отправить запрос повторно автоматически.  


### Важно соблюсти следующие пункты:

1. Код должен быть написан вменяемо с точки зрения норм программирования и ООП  
2. Circuit Breaker не должен вызывать напрямую внешний сервис. В коде должна быть абстракция, которая умеет вызывать интеграция (Что-то вроде класса ApiClient). В нем должна быть инкапсулирована логика работы с Circuit Breaker  
3. Код должен поддерживать 2 интеграции с внешними сервисами. Circuit Breaker не должен быть Singleton  

ServerApp - простой сервер отвечающий на GET запрос от клиента.

ClientApp - простой генератор запросов, в котором реализована логика CircuitBreaker.

CircuitBreaker - если количество запросов с ошибкой равно или превышает количество допустимых, включаем breaker с задержкой на указанное время.

CircuitBreakerV2 - если запрос приходит с ошибкой, октрываем прерыватель и смотрим на разницу между текущим временем и временем возникновения последней ошибки. Если эта разница больше указанного времени перезагрузки, закрываем прерыватель.

CircuitBreakerV3 - объединенная логика предыдущих двух прерывателей.
